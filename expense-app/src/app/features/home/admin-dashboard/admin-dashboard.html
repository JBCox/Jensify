<!-- Admin Dashboard - Rebuild Trigger -->
<div class="jensify-dashboard-container">
  <!-- Header -->
  <div class="jensify-dashboard-header">
    <div class="jensify-header-content">
      <h1 class="jensify-title">Admin Dashboard</h1>
      <p class="jensify-subtitle">Manage organization, users, and system settings</p>
    </div>
    <div class="jensify-header-actions">
      <button mat-raised-button color="primary" (click)="onManageUsers()">
        <mat-icon>people</mat-icon>
        Manage Users
      </button>
    </div>
  </div>

  @if (metrics$ | async; as metrics) {
  <!-- Metrics Row -->
  <div class="jensify-metrics-grid">
    <app-metric-card
      icon="people"
      label="Total Users"
      [value]="metrics.totalUsers.toString()"
      variant="primary">
    </app-metric-card>

    <app-metric-card
      icon="person_check"
      label="Active Users"
      [value]="metrics.activeUsers.toString()"
      variant="success">
    </app-metric-card>

    <app-metric-card
      icon="mail"
      label="Pending Invitations"
      [value]="metrics.pendingInvitations.toString()"
      variant="warning">
    </app-metric-card>

    <app-metric-card
      icon="health_and_safety"
      label="System Health"
      [value]="metrics.systemHealth"
      variant="success">
    </app-metric-card>
  </div>

  <!-- System Overview -->
  <div class="jensify-section">
    <div class="jensify-section-header">
      <h2 class="jensify-section-title">
        <mat-icon>analytics</mat-icon>
        System Overview
      </h2>
    </div>

    <div class="jensify-charts-grid">
      <!-- Total Expenses Line Chart -->
      <div class="jensify-card chart-card">
        <div class="chart-header">
          <div class="chart-icon-wrapper">
            <mat-icon>receipt_long</mat-icon>
          </div>
          <div class="chart-info">
            <div class="chart-value">{{ metrics.totalExpenses }}</div>
            <div class="chart-label">Total Expenses</div>
          </div>
        </div>
        <div class="chart-container line-chart">
          <!-- CSS/SVG Line Chart Representation -->
          <svg viewBox="0 0 300 100" preserveAspectRatio="none" class="chart-svg">
            <path d="M0,80 C50,80 50,30 100,30 C150,30 150,60 200,60 C250,60 250,10 300,10" 
                  fill="none" stroke="url(#orangeGradient)" stroke-width="3" />
            <defs>
              <linearGradient id="orangeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#F7580C;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#FF8A4D;stop-opacity:1" />
              </linearGradient>
            </defs>
            <!-- Area under curve -->
            <path d="M0,80 C50,80 50,30 100,30 C150,30 150,60 200,60 C250,60 250,10 300,10 V100 H0 Z" 
                  fill="url(#orangeAreaGradient)" opacity="0.2" />
            <defs>
              <linearGradient id="orangeAreaGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#F7580C;stop-opacity:0.5" />
                <stop offset="100%" style="stop-color:#F7580C;stop-opacity:0" />
              </linearGradient>
            </defs>
          </svg>
        </div>
      </div>

      <!-- Monthly Spend Bar Chart -->
      <div class="jensify-card chart-card">
        <div class="chart-header">
          <div class="chart-icon-wrapper">
            <mat-icon>payments</mat-icon>
          </div>
          <div class="chart-info">
            <div class="chart-value">{{ formatCurrency(metrics.monthlySpend) }}</div>
            <div class="chart-label">Monthly Spend</div>
          </div>
        </div>
        <div class="chart-container bar-chart">
          <div class="bar-group">
            <div class="bar" style="height: 40%"></div>
            <div class="bar active" style="height: 70%"></div>
            <div class="bar" style="height: 50%"></div>
            <div class="bar" style="height: 85%"></div>
            <div class="bar" style="height: 60%"></div>
            <div class="bar" style="height: 90%"></div>
            <div class="bar" style="height: 45%"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  }

  <!-- Quick Actions -->
  <div class="jensify-section">
    <div class="jensify-section-header">
      <h2 class="jensify-section-title">
        <mat-icon>settings</mat-icon>
        Quick Actions
      </h2>
    </div>

    <div class="jensify-card">
      <div class="jensify-action-grid">
        <button mat-raised-button class="jensify-action-card" (click)="onManageUsers()">
          <mat-icon>people</mat-icon>
          <div class="action-label">User Management</div>
          <div class="action-desc">Invite users, manage roles</div>
        </button>

        <button mat-raised-button class="jensify-action-card" (click)="onViewApprovals()">
          <mat-icon>task_alt</mat-icon>
          <div class="action-label">Approvals Queue</div>
          <div class="action-desc">Review pending expenses</div>
        </button>

        <button mat-raised-button class="jensify-action-card" (click)="onViewFinance()">
          <mat-icon>account_balance</mat-icon>
          <div class="action-label">Finance Dashboard</div>
          <div class="action-desc">View financial reports</div>
        </button>

        <button mat-raised-button class="jensify-action-card" routerLink="/expenses">
          <mat-icon>receipt_long</mat-icon>
          <div class="action-label">All Expenses</div>
          <div class="action-desc">Browse all expenses</div>
        </button>
      </div>
    </div>
  </div>
</div>
